---
title: "CCNES_Table_Mean"
author: "Min Zhang"
date: "5/16/2020"
output:
  html_document:
    df_print: paged
  word_document: default
---

```{r setup, include=FALSE}
#install.packages("kableExtra")
library(knitr)
library(kableExtra)
knitr::opts_chunk$set(echo = TRUE)
#Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
```


```{r read in data, include=FALSE}
rm(list = ls())
source("~/Documents/Min/Coding/DataUploadAutomation/Measures/CCNES/CCNES.R")

#sentific notation
options(digits = 3)
```



```{r treatment mean, echo=FALSE}
# Treatment Progress sheet

Progress <- select(CCNES_PREP, c(FamID, GroupAssignment, Timepoint, starts_with("srm")))
Progress$Row_Mean <- rowMeans(select(CCNES_PREP,c(starts_with("srm"))), na.rm = T)
ID <- c(as.character(Progress$FamID))

Progress$site <- ifelse(startsWith(ID, "9"),"UO","UPMC")


Progress_Mean <- Progress %>%
  group_by(GroupAssignment,Timepoint,site) %>%
  summarise(GroupMean = mean(Row_Mean,na.rm = T),count = n())

UO <- Progress_Mean[Progress_Mean$site == "UO",]
UPMC <- Progress_Mean[Progress_Mean$site == "UO",]

Both_site_Mean <- Progress_Mean %>%
  group_by(GroupAssignment, Timepoint) %>%
  summarise(BothSiteMean = mean(GroupMean,na.rm = T),n = sum(count))
#Progress_Mean <- Progress_Mean[order(GroupAssignment),] 



colnames(UO)[colnames(UO) == "GroupMean"] = "UO_CCNES"
colnames(UPMC)[colnames(UPMC) == "GroupMean"] = "UO_CCNES"

#test <- t(UO)

t <- data.frame(  UO[,"UO_CCNES"],UPMC[,"UO_CCNES"], Both_site_Mean[,c("BothSiteMean","n")])

t <- t(t)
t <- data.frame(t)
Timepoint_names <- c("T1","T2", "T3", "T4","T1","T2", "T3", "T4","T1","T2", "T3", "T4")
setnames(t, names(t), Timepoint_names)

```

```{r table}
kable(t) %>%
  kable_styling(bootstrap_options = "striped", full_width = F) %>%
  add_header_above(c(" " = 1, "DBT Group means" = 4, "FSU means" = 4, "Controls means" = 4))
  

```
***Used CCNES Validation subscale only, information on Invalidation can be found in the data se

